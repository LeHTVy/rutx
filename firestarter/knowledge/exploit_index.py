"""Exploit database index."""

from knowledge.llamaindex_setup import LlamaIndexKnowledgeBase
from typing import Dict, Any, Optional


class ExploitIndex:
    """Exploit database index wrapper."""
    
    def __init__(self, knowledge_base: LlamaIndexKnowledgeBase):
        """Initialize exploit index.
        
        Args:
            knowledge_base: LlamaIndex knowledge base instance
        """
        self.kb = knowledge_base
        if "exploits" not in self.kb.indices:
            self.kb.setup_exploit_index()
    
    def query(self, query: str, top_k: int = 5) -> Dict[str, Any]:
        """Query exploit database.
        
        Args:
            query: Search query
            top_k: Number of results
            
        Returns:
            Query results
        """
        return self.kb.query(query, index_type="exploits", top_k=top_k)
